(this["webpackJsonp@jsbook-audrynyonata/local-client"]=this["webpackJsonp@jsbook-audrynyonata/local-client"]||[]).push([[0],{183:function(e,t,n){},229:function(e,t){},265:function(e,t,n){},266:function(e,t,n){},273:function(e,t,n){},274:function(e,t,n){},297:function(e,t,n){},298:function(e,t,n){},299:function(e,t,n){},300:function(e,t,n){},301:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"moveCell",(function(){return k})),n.d(r,"deleteCell",(function(){return D})),n.d(r,"insertCellAfter",(function(){return I})),n.d(r,"updateCell",(function(){return M})),n.d(r,"createBundle",(function(){return F})),n.d(r,"fetchCells",(function(){return A})),n.d(r,"saveCells",(function(){return U}));var c,a=n(137),o=n(43),i=n(1),s=o.c,u=n(36),l=n(143),d=n(4),p=n(5),f=n(140),b=n(44),j=n(3),O=function(e){return e.MOVE_CELL="move_cell",e.DELETE_CELL="delete_cell",e.INSERT_CELL_AFTER="insert_cell_after",e.UPDATE_CELL="update_cell",e.BUNDLE_START="bundle_start",e.BUNDLE_COMPLETE="bundle_complete",e.FETCH_CELLS="fetch_cells",e.FETCH_CELLS_COMPLETE="fetch_cells_complete",e.FETCH_CELLS_ERROR="fetch_cells_error",e.SAVE_CELLS="save_cells",e.SAVE_CELLS_ERROR="save_cells_error",e}({}),h={loading:!1,error:null,focusedIndex:null,order:[],data:{}},m=function(){return Math.random().toString(36).substr(2,5)},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O.SAVE_CELLS_ERROR:return Object(j.a)(Object(j.a)({},e),{},{error:t.payload});case O.FETCH_CELLS:return Object(j.a)(Object(j.a)({},e),{},{loading:!0,error:null});case O.FETCH_CELLS_COMPLETE:var n=t.payload.map((function(e){return e.id})),r=t.payload.reduce((function(e,t){return e[t.id]=t,e}),{});return Object(j.a)(Object(j.a)({},e),{},{loading:!1,error:null,order:n,data:r});case O.FETCH_CELLS_ERROR:return Object(j.a)(Object(j.a)({},e),{},{loading:!1,error:t.payload});case O.MOVE_CELL:var c=t.payload,a=c.id,o=c.direction,i=e.order.findIndex((function(e){return e===a})),s="up"===o?i-1:i+1;if(s<0||s>e.order.length-1)return e;var u=e.order.slice();return u[i]=u[s],u[s]=a,Object(j.a)(Object(j.a)({},e),{},{focusedIndex:a,order:u});case O.DELETE_CELL:var l=t.payload,v=e.data,E=(v[l],Object(f.a)(v,[l].map(b.a))),x=e.order.filter((function(e){return e!==l}));return Object(j.a)(Object(j.a)({},e),{},{focusedIndex:null,data:E,order:x});case O.INSERT_CELL_AFTER:var L,y=t.payload,w=y.id,C=y.type,g=y.content,_={id:m(),type:C,content:g||""},R=e.order.findIndex((function(e){return e===w})),T=R+1;return L=R<0?[_.id].concat(Object(p.a)(e.order)):[].concat(Object(p.a)(e.order.slice(0,T)),[_.id],Object(p.a)(e.order.slice(T))),Object(j.a)(Object(j.a)({},e),{},{focusedIndex:_.id,data:Object(j.a)(Object(j.a)({},e.data),{},Object(d.a)({},_.id,_)),order:L});case O.UPDATE_CELL:var N=t.payload,S=N.id,k=N.content;return Object(j.a)(Object(j.a)({},e),{},{focusedIndex:null,data:Object(j.a)(Object(j.a)({},e.data),{},Object(d.a)({},S,Object(j.a)(Object(j.a)({},e.data[S]),{},{content:k})))});default:return e}},E={},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O.BUNDLE_START:var n=t.payload.cellId;return Object(j.a)(Object(j.a)({},e),{},Object(d.a)({},n,{loading:!0,code:"",error:""}));case O.BUNDLE_COMPLETE:var r=t.payload,c=r.cellId,a=r.bundle;return Object(j.a)(Object(j.a)({},e),{},Object(d.a)({},c,{loading:!1,code:a.code,error:a.error}));default:return e}},L=Object(u.c)({cells:v,bundles:x}),y=n(12),w=n(19),C=n(334),g=n(141),_=n(142),R=n.n(_).a.createInstance({name:"filecache"}),T=function(e){return{name:"fetch-plugin",setup:function(t){t.onLoad({filter:/(^index\.js$)/},(function(){return{loader:"jsx",contents:e}})),t.onLoad({filter:/.*/},function(){var e=Object(w.a)(Object(y.a)().mark((function e(t){var n;return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.getItem(t.path);case 2:if(!(n=e.sent)){e.next=5;break}return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.onLoad({filter:/.css$/},function(){var e=Object(w.a)(Object(y.a)().mark((function e(t){var n,r,c,a,o,i;return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.get(t.path);case 2:return n=e.sent,r=n.data,c=n.request,a=r.replace(/\n/g,"").replace(/"/g,'\\"').replace(/'/g,"\\'"),o="\n          const style = document.createElement('style');\n          style.innerText = '".concat(a,"';\n          document.head.appendChild(style);\n        "),i={loader:"jsx",contents:o,resolveDir:new URL("./",c.responseURL).pathname},e.next=10,R.setItem(t.path,i);case 10:return e.abrupt("return",i);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.onLoad({filter:/.*$/},function(){var e=Object(w.a)(Object(y.a)().mark((function e(t){var n,r,c,a;return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.get(t.path);case 2:return n=e.sent,r=n.data,c=n.request,a={loader:"jsx",contents:r,resolveDir:new URL("./",c.responseURL).pathname},e.next=8,R.setItem(t.path,a);case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}},N=function(){var e=Object(w.a)(Object(y.a)().mark((function e(t){var n;return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=4;break}return e.next=3,g.startService({worker:!0,wasmURL:"https://unpkg.com/esbuild-wasm@0.8.27/esbuild.wasm"});case 3:c=e.sent;case 4:return e.prev=4,e.next=7,c.build({entryPoints:["index.js"],bundle:!0,write:!1,plugins:[{name:"unpkg-path-plugin",setup:function(e){e.onResolve({filter:/(^index\.js$)/},(function(){return{path:"index.js",namespace:"a"}})),e.onResolve({filter:/^\.+\//},(function(e){return{namespace:"a",path:new URL(e.path,"https://unpkg.com"+e.resolveDir+"/").href}})),e.onResolve({filter:/.*/},function(){var e=Object(w.a)(Object(y.a)().mark((function e(t){return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{namespace:"a",path:"https://unpkg.com/".concat(t.path)});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},T(t)],define:{"process.env.NODE_ENV":'"production"',global:"window"},jsxFactory:"_React.createElement",jsxFragment:"_React.Fragment"});case 7:return n=e.sent,e.abrupt("return",{code:n.outputFiles[0].text,error:""});case 11:if(e.prev=11,e.t0=e.catch(4),!(e.t0 instanceof Error)){e.next=17;break}return e.abrupt("return",{code:"",error:e.t0.message});case 17:throw e.t0;case 18:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t){return e.apply(this,arguments)}}(),S=N,k=function(e,t){return{type:O.MOVE_CELL,payload:{id:e,direction:t}}},D=function(e){return{type:O.DELETE_CELL,payload:e}},I=function(e,t,n){return{type:O.INSERT_CELL_AFTER,payload:{id:e,type:t,content:n}}},M=function(e,t){return{type:O.UPDATE_CELL,payload:{id:e,content:t}}},F=function(e,t){return function(){var n=Object(w.a)(Object(y.a)().mark((function n(r){var c;return Object(y.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r({type:O.BUNDLE_START,payload:{cellId:e}}),n.next=3,S(t);case 3:c=n.sent,r({type:O.BUNDLE_COMPLETE,payload:{cellId:e,bundle:c}});case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},A=function(){return function(){var e=Object(w.a)(Object(y.a)().mark((function e(t){var n,r;return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:O.FETCH_CELLS}),e.prev=1,e.next=4,C.a.get("/cells");case 4:n=e.sent,r=n.data,t({type:O.FETCH_CELLS_COMPLETE,payload:r}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),e.t0 instanceof Error&&t({type:O.FETCH_CELLS_ERROR,payload:e.t0.message});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},U=function(){return function(){var e=Object(w.a)(Object(y.a)().mark((function e(t,n){var r,c,a,o;return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n().cells,c=r.data,a=r.order,o=a.map((function(e){return c[e]})),e.prev=2,e.next=5,C.a.post("/cells",{cells:o});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),e.t0 instanceof Error&&t({type:O.SAVE_CELLS_ERROR,payload:e.t0.message});case 10:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t,n){return e.apply(this,arguments)}}()},V=Object(u.d)(L,{},Object(u.a)((function(e){var t,n=e.dispatch,r=e.getState;return function(e){return function(c){e(c),[O.MOVE_CELL,O.UPDATE_CELL,O.INSERT_CELL_AFTER,O.DELETE_CELL].includes(c.type)&&(t&&clearTimeout(t),t=setTimeout((function(){U()(n,r)}),750))}}}),l.a));fetch("demo.json",{headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){e.demo.reverse().forEach((function(e){var t=e.id,n=e.type,r=e.content;V.dispatch({type:O.INSERT_CELL_AFTER,payload:{id:t,type:n,content:r}})}))}));var z=function(){var e=Object(o.b)();return Object(i.useMemo)((function(){return Object(u.b)(r,e)}),[e])},B=(n(183),n(0)),H=function(e){var t=e.action,n=e.icon;return Object(B.jsx)("button",{className:"bu-button bu-is-primary bu-is-small",onClick:t,children:Object(B.jsx)("span",{className:"bu-icon",children:Object(B.jsx)("i",{className:n})})})},P=function(e){var t=e.id,n=z(),r=n.moveCell,c=n.deleteCell;return Object(B.jsxs)("div",{className:"action-bar",children:[Object(B.jsx)(H,{action:function(){return r(t,"up")},icon:"fas fa-arrow-up"}),Object(B.jsx)(H,{action:function(){return r(t,"down")},icon:"fas fa-arrow-down"}),Object(B.jsx)(H,{action:function(){return c(t)},icon:"fas fa-times"})]})},W=n(83),$=n.n(W),q=n(144),J=n.n(q),Q=n(145),G=n.n(Q),K=n(146),X=n.n(K),Y=n(147),Z=n.n(Y),ee=(n(265),function(e){var t=e.initialValue,n=e.onChange,r=e.onExecuteBundle,c=Object(i.useRef)();return Object(B.jsxs)("div",{className:"editor-wrapper",children:[Object(B.jsxs)("div",{className:"button-wrapper",children:[Object(B.jsx)("button",{className:"bu-button button-format bu-is-primary bu-is-small",onClick:function(){var e=c.current.getModel().getValue(),t=J.a.format(e,{parser:"babel",plugins:[G.a],useTabs:!1,semi:!0,singleQuote:!0}).replace(/\n$/,"");c.current.setValue(t)},children:"Format"}),Object(B.jsx)("button",{className:"bu-button button-play bu-is-primary bu-is-small",onClick:r,children:Object(B.jsx)("span",{className:"bu-icon",children:Object(B.jsx)("i",{className:"fas fa-play"})})})]}),Object(B.jsx)($.a,{editorDidMount:function(e,t){var r;c.current=t,t.onDidChangeModelContent((function(){n(e())})),null===(r=t.getModel())||void 0===r||r.updateOptions({tabSize:2}),new Z.a(window.monaco,X.a,t).highLightOnDidChangeModelContent((function(){}),(function(){}),void 0,(function(){}))},value:t,language:"javascript",height:"100%",options:{wordWrap:"on",minimap:{enabled:!1},showUnused:!1,folding:!1,lineNumbersMinChars:3,fontSize:16,tabSize:2,scrollBeyondLastLine:!1,automaticLayout:!0}})]})}),te=(n(266),"\n  <html>\n    <head>\n      <style>html { background-color: white; }</style>\n    </head>\n    <body>\n      <div id=\"root\"></div>\n      <div id=\"portal\"></div>\n      <script>\n        const handleError = (err) => {\n          const root = document.querySelector('#root');\n          root.innerHTML = '<div style=\"color: red;\"><h4>Runtime Error</h4>' + err + '</div>';\n          console.error(err);\n        };\n\n        window.addEventListener('error', (event) => {\n          event.preventDefault();\n          handleError(event.error);\n        });\n\n        window.addEventListener('message', (event) => {\n          try {\n            const code = event.data;\n            eval(code);\n          } catch (err) {\n            handleError(err);\n          }\n        }, false);\n      <\/script>\n    </body>\n  </html>\n"),ne=function(e){var t=e.code,n=e.error,r=Object(i.useRef)();return Object(i.useEffect)((function(){r.current.srcdoc=te,setTimeout((function(){r.current.contentWindow.postMessage(t,"*")}),50)}),[t]),Object(B.jsxs)("div",{className:"preview-wrapper",children:[Object(B.jsx)("iframe",{title:"preview",ref:r,sandbox:"allow-scripts",srcDoc:te}),n&&Object(B.jsx)("div",{className:"preview-error",children:n})]})},re=n(16),ce=n(148),ae=(n(273),function(e){var t,n=e.direction,r=e.children,c=Object(i.useState)(window.innerHeight),a=Object(re.a)(c,2),o=a[0],s=a[1],u=Object(i.useState)(window.innerWidth),l=Object(re.a)(u,2),d=l[0],p=l[1],f=Object(i.useState)(.65*window.innerWidth),b=Object(re.a)(f,2),O=b[0],h=b[1];return Object(i.useEffect)((function(){var e,t=function(){e&&clearTimeout(e),e=setTimeout((function(){s(window.innerHeight),p(window.innerWidth),O>.75*window.innerWidth&&h(.75*window.innerWidth)}),100)};return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}),[O]),t="horizontal"===n?{className:"resize-horizontal",minConstraints:[.2*d,1/0],maxConstraints:[.75*d,1/0],height:1/0,width:O,resizeHandles:["e"],onResizeStop:function(e,t){h(t.size.width)}}:{minConstraints:[1/0,24],maxConstraints:[1/0,.9*o],height:300,width:1/0,resizeHandles:["s"]},Object(B.jsx)(ce.ResizableBox,Object(j.a)(Object(j.a)({},t),{},{children:r}))}),oe=n(149),ie=(n(274),function(e){var t,n=e.cell,r=z(),c=r.updateCell,a=r.createBundle,o=s((function(e){return e.bundles[n.id]})),u=(t=n.id,s((function(e){var n,r=e.cells,c=r.data,a=r.order.map((function(e){return c[e]})),o=[],i=Object(oe.a)(a);try{for(i.s();!(n=i.n()).done;){var s=n.value;if("code"===s.type&&(s.id===t?o.push("\n      import _React from 'react';\n      import _ReactDOM from 'react-dom';\n      var print = (value, end) => {\n        const root = document.querySelector('#root');\n        const portalRoot = document.querySelector('#portal');\n        \n        if (typeof value === 'object') {\n          if (value.$$typeof && value.props) {\n            const temp = document.createElement('div');\n            const portal = _ReactDOM.createPortal(value, root);\n            _ReactDOM.render(portal, temp, () => portalRoot.appendChild(temp));\n            if (end !== undefined && end !== null) root.append(end);\n          } else {\n            root.append(JSON.stringify(value));\n            if (end !== undefined && end !== null) root.append(end);\n            else root.append(document.createElement('br'));\n          }\n        } else {\n          root.append(value);\n          if (end !== undefined && end !== null) root.append(end);\n          else root.append(document.createElement('br'));\n      }\n      }\n    "):o.push("var print = () => {}"),o.push(s.content)),s.id===t)break}}catch(u){i.e(u)}finally{i.f()}return o})).join("\n"));return Object(i.useEffect)((function(){if(o){var e=setTimeout(Object(w.a)(Object(y.a)().mark((function e(){return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a(n.id,u);case 1:case"end":return e.stop()}}),e)}))),1e3);return function(){clearTimeout(e)}}a(n.id,u)}),[u,n.id,a]),Object(B.jsx)(ae,{direction:"vertical",children:Object(B.jsxs)("div",{style:{display:"flex",flexDirection:"row",height:"calc(100% - 10px)"},children:[Object(B.jsx)(ae,{direction:"horizontal",children:Object(B.jsx)(ee,{initialValue:n.content,onChange:function(e){return c(n.id,e)},onExecuteBundle:function(){return a(n.id,u)}})}),Object(B.jsx)("div",{className:"progress-wrapper",children:!o||o.loading?Object(B.jsx)("div",{className:"progress-cover",children:Object(B.jsx)("progress",{className:"bu-progress bu-is-small bu-is-primary",max:"100",children:"Loading"})}):Object(B.jsx)(ne,{code:o.code,error:o.error})})]})})}),se=n(86),ue=(n(297),function(e){var t=e.cell,n=z().updateCell,r=Object(i.useRef)(null),c=Object(i.useState)(!1),a=Object(re.a)(c,2),o=a[0],s=a[1];return Object(i.useEffect)((function(){var e=function(e){r.current&&e.target&&r.current.contains(e.target)||s(!1)};return window.addEventListener("click",e,{capture:!0}),function(){window.removeEventListener("click",e,{capture:!0})}}),[]),o?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("div",{"data-color-mode":"light",className:"text-editor",ref:r,children:Object(B.jsx)(se.a,{value:t.content,onChange:function(e){return n(t.id,e||"")}})}),Object(B.jsx)("div",{className:"save-bar",children:Object(B.jsx)("button",{className:"bu-button bu-is-primary bu-is-small",children:Object(B.jsx)("i",{className:"fas fa-check"})})})]}):Object(B.jsx)("div",{"data-color-mode":"light",className:"text-editor bu-card",onClick:function(){return s(!0)},children:Object(B.jsx)("div",{className:"bu-card-content",children:Object(B.jsx)(se.a.Markdown,{source:t.content||"Click to edit"})})})}),le=(n(298),function(e){var t,n=e.cell,r=e.focused,c=n.id;return t="code"===n.type?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("div",{className:"action-bar-wrapper",children:Object(B.jsx)(P,{id:c})}),Object(B.jsx)(ie,{cell:n})]}):Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(ue,{cell:n}),Object(B.jsx)(P,{id:c})]}),Object(B.jsx)("div",{className:"cell-list-item ".concat(r&&"focused"),children:t})}),de=(n(299),function(e){var t=e.action,n=e.label;return Object(B.jsxs)("button",{className:"bu-button bu-is-rounded bu-is-primary bu-is-small",onClick:t,children:[Object(B.jsx)("span",{className:"bu-icon bu-is-small",children:Object(B.jsx)("i",{className:"fas fa-plus"})}),Object(B.jsx)("span",{children:n})]})}),pe=function(e){var t=e.forceVisible,n=e.previousCellId,r=z().insertCellAfter;return Object(B.jsxs)("div",{className:"add-cell ".concat(t&&"force-visible"),children:[Object(B.jsxs)("div",{className:"add-buttons",children:[Object(B.jsx)(de,{action:function(){return r(n,"code")},label:"Code"}),Object(B.jsx)(de,{action:function(){return r(n,"text")},label:"Text"})]}),Object(B.jsx)("div",{className:"divider"})]})},fe=(n(300),function(){var e=z().fetchCells,t=s((function(e){var t=e.cells,n=t.order,r=t.data;return n.map((function(e){return r[e]}))})),n=s((function(e){return e.cells})),r=n.loading,c=n.order,a=n.focusedIndex;Object(i.useEffect)((function(){var e;null===(e=document.querySelector(".focused"))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center"})}),[c,a]),Object(i.useEffect)((function(){e(),C.a.get("/filename").then((function(e){document.title="".concat(e," | JSBook | React App")}))}),[]);var o=t.map((function(e){return Object(B.jsxs)(i.Fragment,{children:[Object(B.jsx)(le,{cell:e,focused:e.id===a}),Object(B.jsx)(pe,{previousCellId:e.id})]},e.id)}));return Object(B.jsxs)("div",{className:"cell-list",children:[Object(B.jsx)(pe,{forceVisible:0===t.length,previousCellId:null}),0!==t.length||r?o:Object(B.jsx)("div",{className:"bu-card empty",children:Object(B.jsx)("div",{className:"bu-card-content",children:"Add a new cell to get started"})})]})}),be=document.getElementById("root"),je=function(){return Object(B.jsx)(o.a,{store:V,children:Object(B.jsx)(fe,{})})};Object(a.createRoot)(be).render(Object(B.jsx)(je,{}))},77:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=77}},[[301,1,2]]]);
//# sourceMappingURL=main.90813a8b.chunk.js.map